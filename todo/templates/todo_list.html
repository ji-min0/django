{% extends 'base.html' %}{% block content %}
<div class="container" style="margin-top: 15px">
  {% if request.user.is_authenticated %}
  <div style="display: flex; justify-content: space-between">
    <h1>{{ request.user.username }}의 Todo List</h1>
    <button class="create-button" onclick="location.href='{% url 'cbv_todo_create' %}'">생성하기</button>
  </div>
  <form method="GET" style="margin: 10px">
    <input type="text" placeholder="제목 또는 내용을 입력하세요." name="q"
      value="{% if request.GET.q %}{{ request.GET.q }}{% endif %}">
    <button class="search-button">Search</button>
  </form>
  <ul>
    {% for todo in page_obj.object_list %}
    <li><a href="{% url 'todo_info' todo.id %}">{{ todo.title }}</a></li>
    {% endfor %}
  </ul>
  <!-- 페이지네이션 -->
  <div class="pagination">
    {% if page_obj.has_previous %}
    <a href="?page=1">&laquo; First</a>
    <a href="?page={{ page_obj.previous_page_number }}">Previous</a>
    {% else %}
    <p>&laquo; First</p>
    <p>Previous</p>
    {% endif %}

    {% for num in page_obj.paginator.page_range %}
    {% if num > page_obj.number|add:-3 and num < page_obj.number|add:3 %}
    {% if num == page_obj.number %}
    <span class="active" style="border-radius: 4px; background-color: #fff122">{{ num }}</span>
    {% else %}
    <a href="?page={{ num }}">{{ num }}</a>
    {% endif %}
    {% endif %}
    {% endfor %}

    {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}">Next</a>
    <a href="?page={{ page_obj.paginator.num_pages }}">Last &raquo;</a>
    {% else %}
    <p>Next</p>
    <p>Last &raquo;</p>
    {% endif %}
  </div>
  {% endif %}
</div>

{% endblock %}
